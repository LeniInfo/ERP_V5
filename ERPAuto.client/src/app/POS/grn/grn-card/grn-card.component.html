<div class="overlay">
  <div class="container">
    <div class="main-card">

      <!-- ðŸ”· NAVBAR -->
      <div class="inner-navbar d-flex justify-content-between align-items-center">
        <h5>GRN â€“ {{ invoice.shipmentNumber }}</h5>

        <button class="btn btn-sm btn-outline-light" (click)="close()">âœ–</button>
      </div>

      <!-- ðŸŒ¤ï¸ HEADER SECTION -->
      <div class="form-section header-highlight">
        <div class="row align-items-center">
          <div class="col-md-4 d-flex align-items-center">
            <label class="form-label mb-0">Invoice No:</label>
            <input type="text"
                   class="form-control form-control-sm"
                   style="width: auto; flex: none;"
                   [value]="invoice.shipmentNumber" readonly />
          </div>
          <div class="col-md-5 d-flex align-items-center">
            <label class="form-label mb-0" style="margin-right: 8px; white-space: nowrap;">
              Shipment Date:
            </label>
            <input type="text"
                   [value]="invoice.shipmentDate | date:'dd-MM-yyyy'"
                   readonly
                   style="width: 120px; flex: none;"
                   class="form-control form-control-sm" />
          </div>


          <div class="col-md-3 d-flex align-items-center">
            <label class="form-label mb-0">Supplier:</label>
            <input type="text"
                   class="form-control form-control-sm"
                   style="width: auto; flex: none;"
                   [value]="invoice.supplierCode" readonly />
          </div>
        </div>
      </div>


      <!-- ðŸ§¾ DETAILS SECTION (TABLE ONLY) -->
      <div class="form-section">

        <div class="table-container">
          <div class="table-rounded">
            <div class="table-scroll">
              <table class="table table-striped table-hover mb-0">
                <thead class="table-header">
                  <tr>
                    <th>#</th>
                    <th>Part</th>
                    <th>Make</th>
                    <th class="text-end">Ordered Qty</th>
                    <th class="text-end">Received Qty</th>
                    <th class="text-end">Balance Qty</th>
                    <th class="text-end">Qty</th>
                    <th class="text-end">Price</th>
                    <th class="text-end">Total</th>
                    <th>Select</th> <!-- Checkbox last column -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let d of details; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ d.part }}</td>
                    <td>{{ d.make }}</td>
                    <td class="text-end">{{ d.ordQty }}</td>
                    <td class="text-end">{{ d.receivedQty }}</td>
                    <td class="text-end">{{ d.balanceQty }}</td>
                    <td class="text-end">
                      <input type="text"
                             class="form-control form-control-sm text-end received-qty"
                             [(ngModel)]="d.newQty"
                             (input)="onReceivedQtyChange(d)" />
                    </td>
                    <td class="text-end">{{ d.unitPrice | number:'1.2-2' }}</td>
                    <td class="text-end">{{ (d.receivedQty || 0) * d.unitPrice | number:'1.2-2' }}</td>
                    <td class="text-center">
                      <input type="checkbox"
                             [(ngModel)]="d.selected"
                             (change)="onRowSelect(d)" />
                    </td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>

        <!-- ðŸ”˜ ACTIONS -->
        <div class="text-end mt-3">
          <button class="btn btn-secondary me-2" (click)="close()">Close</button>
          <button class="btn btn-primary" (click)="saveGrn()">Save GRN</button>
        </div>

      </div>

    </div>
  </div>
</div>
